import re
import sys
import csv
import glob
from time import sleep
from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from pyexcel.cookbook import merge_all_to_a_book

# Set parameters for program
main_data = "http://www.espn.com/fantasy/football/story/_/page/"
week = 9
links = ["17ranksWeek"+str(week)+"QBPPR", "17ranksWeek"+str(week)+"RBPPR", "17ranksWeek"+str(week)+"WRPPR", "17ranksWeek"+str(week)+"TEPPR", "17ranksWeek"+str(week)+"KPPR", "17ranksWeek"+str(week)+"DSTPPR"]
positions = ["QB", "RB", "WR", "TE", "K", "DST"]
ranks = []
new_file = "Week_9_Ranks"

ranks = [[['Michael Thomas', '2.0'], ['Mike Evans', '3.0'], ['Julio Jones', '3.2'], ['Dez Bryant', '4.4'], ['A.J. Green', '5.2'], ['Doug Baldwin', '5.6'], ['DeAndre Hopkins', '6.2'], ['Tyreek Hill', '8.4'], ['Jarvis Landry', '8.6'], ['Michael Crabtree', '9.2'], ['Golden Tate', '12.4'], ['Demaryius Thomas', '12.6'], ['Larry Fitzgerald', '13.0'], ['Amari Cooper', '15.2'], ['Devin Funchess', '15.8'], ['Jordy Nelson', '17.0'], ['Alshon Jeffery', '17.8'], ['Emmanuel Sanders', '19.2'], ['DeSean Jackson', '20.2'], ['Will Fuller V', '20.2'], ['DeVante Parker', '21.0'], ['Sterling Shepard', '21.0'], ['Davante Adams', '22.6'], ['Marvin Jones Jr.', '23.2'], ['T.Y. Hilton', '25.6'], ['Mohamed Sanu', '26.2'], ['Rishard Matthews', '28.8'], ['Jeremy Maclin', '29.0'], ['Cooper Kupp', '29.6'], ['Nelson Agholor', '29.8'], ['Robert Woods', '30.8'], ['Tyler Lockett', '32.4'], ['Marqise Lee', '34.0'], ['Paul Richardson', '34.2'], ['Ted Ginn Jr.', '34.6'], ['Sammy Watkins', '35.2'], ['Josh Doctson', '36.8'], ['Randall Cobb', '37.4'], ['John Brown', '40.0'], ['Mike Wallace', '40.4'], ['Jamison Crowder', '41.2'], ['Marquise Goodwin', '42.8'], ['Corey Davis', '43.0'], ['Kenny Stills', '44.2'], ['Eric Decker', '44.4'], ['Allen Hurns', '45.8'], ['Ryan Grant', '46.6'], ['Roger Lewis', '48.6'], ['Jermaine Kearse', '48.8'], ['Willie Snead', '48.8'], ['Bennie Fowler III', '49.0'], ['Terrance Williams', '49.6'], ['Taylor Gabriel', '49.8'], ['Terrelle Pryor Sr.', '50.0'], ['Donte Moncrief', '50.0'], ['Cole Beasley', '50.0'], ['Brandon LaFell', '50.0'], ['Brandon Coleman', '50.0'], ['Demarcus Robinson', '50.2'], ['J.J. Nelson', '50.6']], [['Drew Brees', '1.4'], ['Russell Wilson', '2.2'], ['Dak Prescott', '2.4'], ['Alex Smith', '4.4'], ['Cam Newton', '5.8'], ['Carson Wentz', '6.2'], ['Matthew Stafford', '6.2'], ['Jameis Winston', '8.6'], ['Derek Carr', '10.2'], ['Kirk Cousins', '10.6'], ['Matt Ryan', '11.0'], ['Marcus Mariota', '11.2'], ['Jared Goff', '12.2'], ['Eli Manning', '14.8'], ['Jay Cutler', '17.0'], ['Jacoby Brissett', '17.4'], ['Blake Bortles', '17.4'], ['Andy Dalton', '18.2'], ['Brett Hundley', '18.4'], ['Tom Savage', '18.6'], ['Joe Flacco', '19.8'], ['Drew Stanton', '20.2'], ['C.J. Beathard', '22.4'], ['Brock Osweiler', '23.4'], ['Jimmy Garoppolo', '25.2']], [['Ezekiel Elliott', '1.4'], ['Todd Gurley II', '2.6'], ['Kareem Hunt', '3.4'], ['Leonard Fournette', '3.8'], ['Mark Ingram', '4.4'], ['Lamar Miller', '6.6'], ['Devonta Freeman', '7.8'], ['Christian McCaffrey', '9.0'], ['Alvin Kamara', '9.2'], ['Carlos Hyde', '10.8'], ['DeMarco Murray', '11.2'], ['Doug Martin', '11.8'], ['Chris Thompson', '11.8'], ['Adrian Peterson', '12.4'], ['Aaron Jones', '14.2'], ['Joe Mixon', '17.2'], ['Alex Collins', '18.0'], ['Javorius Allen', '19.6'], ['Ameer Abdullah', '20.2'], ['C.J. Anderson', '21.0'], ['Tevin Coleman', '21.8'], ['Marshawn Lynch', '23.0'], ['Theo Riddick', '23.0'], ['Frank Gore', '24.8'], ['Orleans Darkwa', '26.0'], ['Jonathan Stewart', '26.4'], ['Kenyan Drake', '28.4'], ['Marlon Mack', '29.4'], ['Rob Kelley', '30.6'], ['Ty Montgomery', '30.8'], ['LeGarrette Blount', '30.8'], ['Derrick Henry', '31.2'], ['Damien Williams', '31.2'], ['Andre Ellington', '33.4'], ['Eddie Lacy', '34.6'], ['Jay Ajayi', '36.2'], ['DeAndre Washington', '37.0'], ['Chris Ivory', '38.6'], ['Wendell Smallwood', '40.4'], ['Shane Vereen', '40.6'], ['Matt Breida', '41.2'], ['Giovani Bernard', '41.6'], ['Thomas Rawls', '42.8'], ['Jamaal Charles', '44.4'], ['Wayne Gallman', '44.4'], ['Jalen Richard', '45.2'], ["D'Onta Foreman", '46.6'], ['Charcandrick West', '47.0'], ['T.J. Yeldon', '47.4'], ['Rod Smith', '48.6'], ['Alfred Morris', '48.8'], ['Devontae Booker', '49.0'], ['Charles Sims', '49.2'], ['Dwayne Washington', '49.6'], ['J.D. McKissic', '50.2'], ['Darren McFadden', '50.8'], ['C.J. Prosise', '50.8']], [['Zach Ertz', '1.0'], ['Travis Kelce', '2.0'], ['Jimmy Graham', '3.8'], ['Evan Engram', '4.0'], ['Cameron Brate', '5.4'], ['Jack Doyle', '5.6'], ['Delanie Walker', '7.8'], ['Jason Witten', '7.8'], ['Vernon Davis', '8.6'], ['Jared Cook', '9.4'], ['Tyler Kroft', '11.4'], ['Austin Hooper', '13.6'], ['Ed Dickson', '14.4'], ['George Kittle', '16.2'], ['Benjamin Watson', '16.4'], ['Ryan Griffin', '16.6'], ['Coby Fleener', '17.4'], ['Julius Thomas', '17.8'], ['Tyler Higbee', '19.2'], ['A.J. Derby', '20.0'], ['Eric Ebron', '20.2'], ['O.J. Howard', '20.2'], ['Martellus Bennett', '20.4'], ['Marcedes Lewis', '23.4'], ['Jermaine Gresham', '23.4'], ['Lance Kendricks', '25.2']], [['Jacksonville Jaguars', '1.4'], ['Philadelphia Eagles', '2.0'], ['Houston Texans', '3.6'], ['Arizona Cardinals', '5.2'], ['Los Angeles Rams', '6.0'], ['Detroit Lions', '6.2'], ['Seattle Seahawks', '6.6'], ['Denver Broncos', '9.4'], ['Cincinnati Bengals', '10.6'], ['New Orleans Saints', '10.8'], ['Carolina Panthers', '11.6'], ['Baltimore Ravens', '11.8'], ['Tennessee Titans', '11.8'], ['Oakland Raiders', '14.8'], ['Green Bay Packers', '15.0'], ['Atlanta Falcons', '15.2'], ['San Francisco 49ers', '15.6'], ['Kansas City Chiefs', '17.6'], ['New York Giants', '18.8'], ['Miami Dolphins', '19.2'], ['Washington Redskins', '19.6'], ['Dallas Cowboys', '20.4'], ['Indianapolis Colts', '25.2'], ['Tampa Bay Buccaneers', '25.4'], ['Minnesota Vikings', '27.8'], ['Pittsburgh Steelers', '28.4'], ['Buffalo Bills', '30.0'], ['New York Jets', '30.0'], ['New England Patriots', '31.4']], [['Jake Elliott', '2.0'], ['Ryan Succop', '3.6'], ['Justin Tucker', '3.8'], ['Harrison Butker', '3.8'], ['Greg Zuerlein', '5.0'], ['Wil Lutz', '5.0'], ['Matt Prater', '6.4'], ['Matt Bryant', '8.0'], ['Graham Gano', '10.0'], ["Ka'imi Fairbairn", '11.2'], ['Robbie Gould', '11.4'], ['Blair Walsh', '12.8'], ['Adam Vinatieri', '13.4'], ['Mason Crosby', '15.2'], ['Giorgio Tavecchio', '15.8'], ['Josh Lambo', '16.2'], ['Mike Nugent', '16.6'], ['Nick Rose', '16.8'], ['Patrick Murray', '17.4'], ['Phil Dawson', '18.6'], ['Brandon McManus', '19.0']]]
stuff = [['apple', 'orange'], ['big', 'small']]
# Print positions to csv file
with open(new_file + ".csv", 'w', newline='') as myfile:
	wr = csv.writer(myfile, quoting=csv.QUOTE_ALL)
	
	for x in range(0, len(ranks)):
		wr.writerow([positions[x] + " Rankings: Week " + str(week)])
		wr.writerow(["Rank", "Name", "Analyst Avg Rank"])
		wr.writerows(ranks[x])
		wr.writerow([])
	
merge_all_to_a_book(glob.glob(new_file + ".csv"), new_file + ".xlsx")